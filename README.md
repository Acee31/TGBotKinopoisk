# Telegram Bot по поиску фильмов

## Описание проекта
Telegram-бот, который позволяет пользователям находить о фильмах, сериалах, аниме, мультфильмах и анимационных сериалах, используя API Кинопоиска (https://kinopoisk.dev/documentation).
Бот принимает через команды определенные запросы пользователей в чате и предоставляет данные о картинах, такие как описание, год выпуска, рейтинг и другие детали.

## Технологии и библиотеки
- Python 3.12: основной язык программирования проекта.
- pyTelegramBotAPI 4.23.0: библиотека для работы с Telegram Bot API, обеспечивающая связь бота с Telegram.
- Peewee 3.17.7: ORM библиотека для работы с базой данных SQlite, используемой для хранения данных о пользователях и их запросах.
- API Кинопоиска: внешний API, через который бот получает данные о картинах.

## Структура проекта
- config_data: Хранит конфигурационные файлы, такие как токен бота и ключ для доступа к API Кинопоиска, доступ к которым получает через `os.getenv()`, ключи хранятся в `.env`. Также содержит команды, которые высвечиваются в меню команд в Telegram.
- database: Модели и функции для работы с базой данных SQlite через Peewee ORM.
- handlers: Содержит обработчики команд и сообщений, которые обрабатывают команды, такие как `/start`, `/search_movie` и т.д. и управляют логикой взаимодействия с бота с пользователем.
- keyboards: Модуль для создания inline и reply кнопок, упрощающих взаимодействия пользователя с ботом.
- states: Модуль, ответственный за управление состояниями пользователя в рамках диалога.
- utils: Содержит функции, которые подключаются к API Кинопоиска и делают запрос в зависимости от команды.

## Установка и настройка
1. Клонирования репозитория:
   ```bash
   git clone <URL репозитория>
   cd <Имя папки проекта>
   ```

2. Установка зависимостей:
   Установить зависимости, указанные в `requirements.txt`
   ```bash
   pip install -r requirements.txt
   ```
   
3. Настройка конфигураций:
   - Создать файл `.env` в корневой директории проекта и добавить туда следующие параметры:
   ```
   BOT_TOKEN = <токен_телеграмм_бота>
   RAPID_API_KEY = <ключ_кинопоиска>
   ```

4. Запуск бота:
   ```bash
   python main.py
   ```

## Команды бота
- `/start` - Начальная команда, проверяет, есть ли пользователь в базе данных. Если нет, создаёт запись с информацией о пользователе и отправляет приветственное сообщение.
- `/help` - Выводит список доступных команд в боте.
- `/movie_search` - Команда для поиска картин без каких-либо уточнений кроме названия и жанра. 
- `/movie_by_rating` - Команда уточняет тип картины и рейтинг для поиска.
- `/low_budget_movie` - Команда уточняет тип картины и ищет картину по заданному типу и по бюджету ниже указанного.
- `/high_budget_movie` - Аналогичная команда с `/low_budget_movie` только ищет выше указанного бюджета.
- `/history` - Выводит поисковую информацию за весь или указанный период.

## Пример сценария использования
1. Пользователь отправляет команду из списка, например, `/movie_search`, указывает название картины и указывает (или не указывает) жанр и количество результатов.
2. Бот отправляет запрос к API Кинопоиска с названием фильма и жанром (если указан пользователем).
3. Бот получает информацию о картине, включая название, описание, рейтинг, год выпуска, возрастной рейтинг, жанры и постер.
4. Бот отправляет сообщение с кнопками и кратким описанием картины.
5. Пользователь выбирает подходящую кнопку и бот отправляет полученную информацию.